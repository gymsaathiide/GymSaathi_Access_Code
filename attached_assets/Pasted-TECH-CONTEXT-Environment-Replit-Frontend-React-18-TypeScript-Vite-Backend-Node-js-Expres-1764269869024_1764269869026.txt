TECH CONTEXT

Environment: Replit

Frontend: React 18 + TypeScript + Vite

Backend: Node.js + Express + TypeScript

State/Data: TanStack Query (React Query)

UI: TailwindCSS + Radix UI (and a custom design similar to current ERP screenshots)

Auth: Session-based express-session, roles: superadmin, admin, trainer, member

Multi-tenant: every user has gymId; admin sees only their gym.

DB: Replit Database (key–value). Assume collections like members, leads, payments, classes, attendance, orders, etc. Use clear key patterns.

Currency: INR only (₹). No $ anywhere in the admin dashboard.

GOAL

Implement a fully functional Admin Dashboard page at route /admin that shows all key KPIs, shortcuts and insights for the current gym and ties into real backend data.

1. Dashboard Layout (Frontend)

Route: /admin (Gym Management → Dashboard in sidebar).

1.1 Top bar & header

Title: Admin Dashboard

Subtitle: Welcome back, {adminName}! Manage your gym operations.

Right side: optional date range filter (Today / This Week / This Month / Custom) that updates KPI + charts.

Below the title: a global search bar:

Placeholder: Search members, leads, classes, payments, orders…

On enter, call /api/admin/search?q=... (you can stub this for now with simple member/lead search).

Results can navigate to appropriate pages.

1.2 KPI Cards Row

Create 5 KPI cards in one responsive row (2 rows on mobile):

Active Members

Value: count of members with active membership.

Subtext: +X this month (difference from last month).

Revenue This Month (₹)

Sum of paid payments for the gym in the selected date range.

Include membership + shop revenue.

Subtext: % change vs last month.

Pending Dues (₹)

Sum of all outstanding dues for members.

Subtext: N members with dues.

Leads in Pipeline

Count of leads with status in ["new", "in_followup"].

Subtext: Follow-ups today: M.

Today’s Check-ins

Count of attendance check-ins today.

Subtext: Yesterday: (value).

These should match the visual style of the existing ERP cards: white/dark card, subtle shadows, icon at top-right, primary rupee formatting.

1.3 Quick Actions Row

Below KPIs, a horizontal row of buttons:

+ Add Member

+ Add Lead

Record Payment

Create Class

Add Product

Open Member Store

Send Renewal Reminders

Each button either:

Opens a modal (e.g., Add Member, Record Payment)
or

Navigates to existing pages (/admin/members, /admin/leads, /admin/billing, /admin/classes, /admin/shop).

Use Radix dialog/drawer for modals.

2. “Today at a Glance” Section

Left side of main grid.

Card: Today at a Glance

Contains a 3-column mini-summary:

Today’s Classes

Count: total classes scheduled today.

Small text: X upcoming · Y ongoing · Z completed.

Attendance Today

Count: number of check-ins from attendance for today.

Small text: vs yesterday +N/-N.

Today’s Collections (₹)

Sum of payments for today.

Small text: Cash / UPI / Card breakdown.

3. Members & Renewals Block

Right side of the grid or second row.

Create a card titled Renewals & Members.

Inside, two tabs or side-by-side sections:

3.1 Expiring Soon

A mini-table with 5–10 rows:

Member name

Plan name

Expiry date

Days left

Action buttons: Renew, WhatsApp, Call

Data: membership records where expiry is within next 7–15 days.

3.2 Overdue

Members whose memberships have expired but status not changed:

Member name

Expired on

Due amount (if billing system stores it)

Action: Send Reminder, Mark Lost

4. Leads & Follow-ups Block

Another card: Leads & Follow-ups.

Content:

KPI line:

New leads this month

Conversion rate: leads converted to members this month.

Table: “Follow-ups Today”

Lead Name

Source (Walk-in / Instagram / Referral / etc.)

Last Contact

Next Follow-up (time)

Actions:

Mark Done

Convert to Member

Filter leads where nextFollowUpDate == today or overdue.

5. Billing & Dues Snapshot

Card: Billing & Dues.

Includes:

Mini-cards inside:

Revenue This Month (again, but smaller)

Paid Invoices

Pending Invoices / Dues

Short table: “Members with Dues”

Member

Due amount (₹)

Last payment date

Actions: Record Payment, Send Reminder

Uses payments/invoices data from billing system.

6. Classes & Attendance Snapshot

Card: Classes & Attendance.

Content:

Today’s Classes List (3–5 rows):

Time

Class name

Trainer

Booked / Capacity

Status

Little bar chart: Attendance (last 7 days):

x-axis: days (Mon–Sun)

y-axis: check-in count

Use Recharts or a small chart library.

7. Shop & Inventory Snapshot

Card: Shop & Inventory.

KPIs:

Shop revenue this month (₹).

Orders today.

Pending orders.

Mini-table:

Last 5 orders:

Member

Items count

Amount

Status.

Mini-list:

3 products with low stock.

8. Alerts / Notifications Panel

At bottom or right side: Alerts.

Examples:

Memberships expiring today: X

Members with high dues > threshold (e.g., ₹5,000)

Leads with missed follow-ups

Products out of stock

Clicking any alert should apply filters and take admin to the appropriate module.

9. Backend API (Admin Dashboard Data)

Create an endpoint:

GET /api/admin/dashboard

It should use the logged-in admin’s gymId from session and return all data needed for the dashboard in one aggregated payload to minimize round-trips.

Suggested response shape:

interface AdminDashboardResponse {
  kpis: {
    activeMembers: number;
    newMembersThisMonth: number;
    revenueThisMonth: number;
    revenueChangePercent: number;
    pendingDuesAmount: number;
    pendingDuesMembers: number;
    leadsInPipeline: number;
    followupsToday: number;
    todaysCheckins: number;
    yesterdaysCheckins: number;
  };
  today: {
    classesSummary: {
      total: number;
      upcoming: number;
      ongoing: number;
      completed: number;
    };
    attendanceToday: {
      checkins: number;
      diffFromYesterday: number;
    };
    collectionsToday: {
      total: number;
      byMethod: {
        cash: number;
        upi: number;
        card: number;
        razorpay: number;
      };
    };
  };
  renewals: {
    expiringSoon: MemberRenewalRow[];
    overdue: MemberRenewalRow[];
  };
  leads: {
    newThisMonth: number;
    conversionRate: number;
    followupsToday: LeadFollowupRow[];
  };
  billing: {
    revenueThisMonth: number;
    paidInvoices: number;
    pendingInvoices: number;
    dues: MemberDueRow[];
  };
  classes: {
    todaysClasses: ClassRow[];
    attendanceLast7Days: { date: string; checkins: number }[];
  };
  shop: {
    revenueThisMonth: number;
    ordersToday: number;
    pendingOrders: number;
    recentOrders: ShopOrderRow[];
    lowStockProducts: LowStockRow[];
  };
  alerts: AlertRow[];
}


Define minimal TypeScript interfaces for those row types in a shared file.

Implement server-side aggregation logic using Replit DB collections for:

members

memberships

attendance

payments

invoices

leads

classes

orders

products

All filtered by gymId.

10. Frontend Data Fetching

Use React Query to call /api/admin/dashboard.

Show loading skeletons while fetching.

Show error state if API fails.

Ensure everything is responsive (desktop/tablet/mobile) with Tailwind grid.

11. Non-Functional Requirements

Security: always derive gymId from session, never from client body.

Performance: aggregation should be efficient; if needed, precompute some stats (e.g., daily attendance count, monthly revenue) and store them.

Code organization: separate controller/service for dashboard aggregation on backend; reusable card and table components on frontend.

Currency: every amount rendered on dashboard uses rupee format, e.g. ₹2,45,000.

FINAL GOAL

After implementing this spec, the Admin Dashboard at /admin will be a complete, production-grade control panel where a gym owner can:

Quickly understand gym health (members, revenue, dues, leads, attendance, shop).

Take immediate actions via quick buttons.

See upcoming risks (expiring memberships, dues, missed follow-ups, low stock).

Use a global search bar to jump anywhere in the system.