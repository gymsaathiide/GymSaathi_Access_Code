You are a senior full-stack engineer (Supabase + modern JS stack, likely React/Next + Node backend).
My application has been migrated and is now facing multiple issues across the entire system.

Your job is to:

Debug and fix all errors

Improve performance (especially login delays)

Make the UI smooth and responsive on all devices

Ensure every feature works correctly end-to-end

Do not give only high-level suggestions. I want:

Concrete analysis

Exact causes

Full corrected code (not partial snippets)

Clear explanations in simple language

Assume you will have access to all relevant files (frontend, backend, Supabase queries, API routes, UI components, etc.).
If something is missing, tell me exactly which file you need.

1Ô∏è‚É£ Order Placement Error ‚Äì Validation & Data Formatting

I am getting this error when placing an order:

400: {"error":"Validation error: Required at \"memberId\"; Expected number, received NaN at \"subtotal\"; Expected number, received NaN at \"totalAmount\"; Required at \"items[0].productName\"; Expected number, received NaN at \"items[0].price\"; Required at \"items[1].productName\"; Expected number, received NaN at \"items[1].price\""}

You must:

Trace the full data flow for order placement:

From the UI (cart / order form)

Through any state management (Redux, Zustand, Context, etc.)

To the API request payload sent to backend

Through backend validation (Zod/Yup/custom validators)

Into the Supabase/DB insert/update queries

Find and fix all causes of NaN and missing fields:

Make sure memberId is always present and valid when required.

Ensure subtotal and totalAmount are numbers, not strings, "", undefined, or NaN.

Ensure each items[i].productName is provided, non-empty, and matches the expected type.

Ensure each items[i].price is a number, not text or NaN.

Fix frontend formatting issues:

Normalize input values (e.g., parse numeric fields using Number() or parseFloat() before sending).

Ensure optional fields are handled gracefully and required fields are visually indicated.

Add protection against sending empty cart items or partially filled items.

Fix backend validation and error handling:

Update your validation schema (Zod/Yup/custom) so types match exactly what the frontend sends.

If necessary, coerce or sanitize values before validation (e.g., string to number).

Replace technical error messages with more user-friendly messages on the frontend while logging the detailed error on the backend.

Provide:

The fixed frontend function that builds and sends the order payload.

The fixed backend handler (route/controller/service) that validates and creates the order.

A short explanation of what was wrong (e.g., ‚Äúprices were strings from input, causing NaN after arithmetic‚Äù).

2Ô∏è‚É£ Admin Dashboard ‚Äì Analytics Blank on Mobile

In mobile view, the Admin Dashboard ‚Üí Analytics page is blank / not rendering.

You must:

Investigate why it only fails on mobile:

Check conditional rendering based on screen size or breakpoints.

Check CSS (e.g., display: none or overflow/height issues for small screens).

Check if any chart/analytics library has issues with small containers (0 width/height).

Check for mobile-only JS errors (e.g., touch events, window size assumptions).

Fix:

Any logic that accidentally hides the Analytics section on small screens.

Layout issues: ensure containers have proper width/height on mobile.

Any component that relies on window or layout metrics before render; guard these cases.

Ensure:

The Analytics page renders correctly on mobile, tablet, and desktop.

No blank screen, no console errors.

If data is loading, show a proper loading spinner/skeleton.

Provide:

The fixed Analytics component(s), including responsive styles.

Any updated CSS/Tailwind/classes used to fix mobile rendering.

3Ô∏è‚É£ Trainer Permissions ‚Äì Role-Based Access Control (RBAC)

Trainers should NOT be able to create orders on any device.
Trainers must ONLY:

View existing orders

Purchase / buy products for themselves (or as defined), but not create orders in the admin sense

You must:

Review the role/permissions model:

How roles are stored (Supabase auth metadata / DB roles table / JWT claims, etc.).

How the frontend checks permissions (role in state/auth context).

How the backend enforces permissions (middleware, guards, policy checks).

Enforce rules:

At the backend: endpoints that create orders must reject requests from users with the ‚Äútrainer‚Äù role.

Return a clear 403 or custom error: e.g., ‚ÄúYou do not have permission to create orders.‚Äù

At the frontend: hide or disable any UI that allows trainers to:

See ‚ÄúCreate Order‚Äù buttons or forms.

Submit order-creation actions meant for admin/super admin.

Ensure that trainers can:

View orders they are allowed to see (e.g., their orders or assigned ones).

Purchase/buy products as intended (follow the correct flow).

Provide:

Updated backend middleware/guard code enforcing roles for order creation.

Updated frontend components that conditionally render buttons/pages based on role.

A short explanation of how RBAC works in this app after your changes.

4Ô∏è‚É£ Global Fixes ‚Äì Supabase, Backend, API, WhatsApp, Email, UI & Mobile

You must do a full audit and fix all errors related to:

4.1 Supabase Database

Check:

Table structures and relationships.

Column types vs how they‚Äôre used in code.

RLS (Row Level Security) policies; ensure authorized roles can access what they need.

Queries for proper select, insert, update, delete usage and error handling.

Fix:

Any mismatched column names, types, or missing columns.

Any RLS policy that blocks legitimate requests.

Any unhandled .error in Supabase responses (frontend or backend).

4.2 Backend Logic & API Validation

Review all API endpoints:

Auth

Orders

Members

Trainers

Products

Notifications

Anything else in the codebase

For each endpoint:

Validate incoming data thoroughly.

Return simple, human-readable error messages, especially when surfaced to users.

Log detailed technical errors on the server side only (for debugging).

Make sure:

All API routes are wired correctly (path, method, handler).

No uncaught exceptions crash the server.

Rate-limiting or protection against accidental multiple submissions where relevant.

4.3 WhatsApp Integration

Find where WhatsApp is integrated (sending order confirmations, alerts, etc.).

Fix:

Any broken API URLs or tokens.

Any formatting that causes failed delivery.

Any missing error handling for failed WhatsApp messages.

Ensure:

Failures in WhatsApp sending do not break the main business flow (e.g., order still gets placed even if WhatsApp fails).

4.4 Email Sending

Identify email provider (SMTP, SendGrid, etc.).

Fix:

Incorrect configuration, env vars, sender address, etc.

Error handling when emails fail ‚Äì log + user-friendly message.

Ensure:

Email issues never silently break core flows like signup, order, or notifications.

4.5 Frontend UI/UX & Mobile Responsiveness

Go through all major pages:

Login

Dashboard(s) per role

Orders

Products

Analytics

Notifications

Profile/settings

Fix:

Broken layouts, overlapping elements, overflow issues.

Buttons too small on mobile, misaligned text, clipped content.

Any component that looks fine on desktop but breaks on mobile/tablet.

Ensure:

A consistent design system (spacing, fonts, colors, buttons).

All screens are fully usable on mobile, tablet, and desktop.

5Ô∏è‚É£ Notification Panel Issue on Mobile

On mobile, the notification UI:

Overlaps content

Requires manual sliding

Disturbs the main layout

You must:

Inspect how notifications are implemented:

Is it a sliding drawer, toast, modal, bottom sheet, etc.?

How is it positioned (fixed, absolute, z-index)?

Fix the notification design:

It should never permanently obstruct important content or interactions.

It should appear in a clean, non-intrusive way (e.g., toast at top/bottom).

It should auto-dismiss after a few seconds, with an option for manual close.

On mobile, ensure safe areas, proper padding, and no weird overlaps.

Provide:

Updated notification component(s) with:

Clean animations

Proper responsive positioning

Auto-close behavior

Any CSS/Tailwind updates.

6Ô∏è‚É£ Super Admin ‚Äì Simple Error Notifications

Add a feature in the Super Admin Dashboard:

Whenever any member, trainer, or admin encounters an error anywhere in the system, the Super Admin should receive a simple, non-technical message explaining what went wrong.

You must:

Implement a central error reporting mechanism, e.g.:

A global error handler in the backend that records:

User ID & role (if available)

Time

Page/endpoint

Short, human-readable error summary

Optional: a Supabase table like error_events to store these.

Implement simple language messages, such as:

‚ÄúA trainer had an issue while placing an order.‚Äù

‚ÄúA member could not complete payment.‚Äù

Do not show stack traces or internal technical details to Super Admin; keep it readable.

In the Super Admin UI:

Add a clear section/panel for ‚ÄúSystem Issues‚Äù or ‚ÄúError Reports‚Äù.

Show a list of recent errors with:

Role (member/trainer/admin)

Simple message

Time

Optional: link to more detail if needed.

Provide:

Backend code that logs these error events.

Frontend code for the Super Admin to view them.

7Ô∏è‚É£ Remove ‚ÄúBranch 2‚Äù and ‚ÄúBranch 3‚Äù Completely

‚ÄúBranch 2‚Äù and ‚ÄúBranch 3‚Äù do not make sense in the current system.

You must:

Remove all references to Branch 2 and Branch 3 from:

UI (dropdowns, filters, tables, dashboards).

Navigation, sidebars, and forms.

Any conditional logic showing those branches.

Check the backend & DB:

If branches are stored in a table, handle these values properly:

Either remove them if safe, or mark them inactive.

Ensure no filters or queries rely on Branch 2 & 3 anymore.

Ensure removing them does not break data integrity.

Provide:

Updated components without Branch 2 & 3.

Any DB migration or cleaning steps needed.

8Ô∏è‚É£ Reduce Login Delays & Improve Smoothness

Logging in should be fast and smooth, with minimal delays.

You must:

Investigate the current login flow:

Number of API calls made during login.

Any heavy data load (e.g., fetching whole dashboards immediately).

Any unnecessary waits or timeouts.

Optimize performance:

Avoid repeated or redundant API calls.

Use lazy loading or on-demand fetching for heavy data (e.g., analytics).

Cache or persist user data where appropriate.

Make sure Supabase auth calls are used efficiently.

Improve UX:

Add a clear loading indicator during login.

Ensure user sees feedback immediately (e.g., ‚ÄúLogging you in‚Ä¶‚Äù).

Avoid freezing or appearing stuck.

Provide:

Updated login code (frontend and backend).

A short explanation of what changes improved performance.

9Ô∏è‚É£ Final QA ‚Äì No Errors, Fully Smooth App on All Devices

Before finishing:

Conceptually walk through every major flow for each role (member, trainer, admin, super admin):

Login / logout

View dashboard

Place/view orders (as allowed by role)

View analytics

Receive/send notifications

Use WhatsApp/email features

Navigate on mobile/tablet/desktop

For each flow, confirm:

No validation errors unless user inputs are truly invalid.

No unhandled exceptions or console errors.

UI is not broken on mobile, tablet, or desktop.

Animations are smooth and do not break layout.

In your final response, provide:

A checklist of all fixed areas.

Summary of main bugs and how you resolved them.

Any important environment variables and their roles.

Any recommended follow-up improvements.

üîö How I Expect You to Answer

Show actual, full code for each important fix (frontend & backend).

Explain each fix in simple language (especially for errors surfaced to Super Admin).

If you need a specific file or context, tell me:

‚ÄúPlease upload path/to/file.tsx or path/to/route.ts so I can adjust X.‚Äù

Start by confirming you understand all the above points, then tell me which files you need first (e.g., package.json, main backend entry, main frontend entry, Supabase config, key pages like Order, Analytics, Notifications, Login, and Super Admin dashboard).