You are a senior full-stack engineer.
Implement a new Security Audit module in the Super Admin panel with the following exact requirements.

ğŸ” 1. Purpose of the Security Audit

This section is ONLY for displaying functional errors that users encounter during normal system usage.

What counts as a functional error?

Examples:

Failed order creation

Payment errors

API validation errors

Missing required fields

Invalid operations based on permissions

Failed notifications or message sending

Any user-triggered action where the system responds with â€œerrorâ€

What should NOT be logged?

âŒ Technical errors (stack traces, exception blocks, SQL errors)
âŒ Routine actions (login/logout/navigation)
âŒ Successful calls
âŒ System logs, console logs, background jobs
âŒ Backend debugging messages

ğŸ“„ 2. Database Table Needed (security_audit)

Create or update a table with columns:

Column	Type	Description
id	uuid	primary key
user_id	uuid	user who caused the error
role	text	role of the user (member, trainer, admin)
error_message	text	simplified human-readable description
action	text	what the user was trying to do
created_at	timestamp	default NOW()
expires_at	timestamp	auto-delete after 3 days

NOTE:
Use expires_at = NOW() + INTERVAL '3 days' so rows expire automatically.

If Supabase supports policies, enable TTL (time-to-live) cleanup, or create a scheduled function that deletes expired rows.

ğŸ§  3. Backend Logic â€“ Error Logging System

Whenever any user action produces an error:

The backend must:

Catch the error

DO NOT return technical details to the frontend

Convert error to simple language

Log it into security_audit table

Return a clean error response to the user

ğŸ—£ 4. Convert Technical Errors â†’ Simple Language

Examples:

Technical Error	What Should Be Saved in Audit
â€œValidationError: missing field â€˜memberIdâ€™ â€	â€œRequired information was missing.â€
â€œForeign key constraint failedâ€	â€œThe requested data was not valid.â€
â€œSupabase insert error: column price expects numericâ€	â€œThe price entered was incorrect or missing.â€
â€œ500 Internal Server Errorâ€	â€œSomething went wrong while processing the request.â€
â€œPermission deniedâ€	â€œYou do not have permission to perform this action.â€

Always convert to simple human-friendly text, NOT technical messages.

ğŸš« 5. Exclude Non-Functional Logs

Do NOT log:

Login attempts

Logout

Navigation

Normal actions that do not fail

Console warnings

Debug logs

System events unrelated to user actions

Only log actual system failures caused by a user action.

ğŸ§¹ 6. Auto-Clear The Audit Logs (3-Day Expiry)

Implement automatic cleanup:

Option A: Supabase RLS + Policy TTL

Use:

expires_at TIMESTAMP DEFAULT NOW() + INTERVAL '3 days'


Then a scheduled database job:

DELETE FROM security_audit WHERE expires_at < NOW();


Runs daily.

Option B: Cron job (backend)

Run once every 24 hours:

DELETE FROM security_audit WHERE created_at < NOW() - INTERVAL '3 days';


Either method is acceptable.

ğŸ–¥ 7. Super Admin UI Requirements

Build or update the Super Admin "Security Audit" page:

Display Columns:

User Role

Error Message (human-readable)

Action attempted

Timestamp

UI Requirements:

No technical logs

No stack traces

No long error messages

Clean, simple language

Mobile responsive

Paginated or scrollable

Auto-hide logs older than 3 days (should not appear in UI)

Example Display:
User	Role	Issue	Time
Raj Verma	Member	Could not complete purchase.	10 mins ago
Trainer A	Trainer	Lacked permission to create order.	1 hour ago
Admin X	Admin	Failed to send notification.	3 hours ago
ğŸŒ 8. Implementation Rules

Do not break existing logic.

Ensure the system never stores sensitive technical info.

All code should follow clean structure.

If table/schema already exists, update it safely.

If any required file is missing, ask me for it.

ğŸ“Œ Final Goal

A simple, readable, safe Security Audit system where Super Admins can understand problems without any technical background, and all logs auto-clear after 3 days.

ğŸ§¾ Ask Me if Needed

If Replit needs files, it must ask:

â€œPlease provide the backend error handler file, the Supabase table schema, and the Super Admin Audit page code so I can apply the changes.â€